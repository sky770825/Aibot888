class ProjectAnalyzer{constructor(){this.analysisData=null;this.init();}init(){this.bindEvents();}bindEvents(){const analyzeBtn=document.getElementById('analyzeProject');const analyzeUploadBtn=document.getElementById('analyzeUploadedFiles');const projectFiles=document.getElementById('projectFiles');if(analyzeBtn){analyzeBtn.addEventListener('click',()=>{const projectPath=document.getElementById('projectPath')?.value;if(projectPath){this.analyzeProject(projectPath);}});}if(analyzeUploadBtn && projectFiles){analyzeUploadBtn.addEventListener('click',()=>{const files=projectFiles.files;if(files.length > 0){this.analyzeUploadedFiles(files);}});}}async analyzeProject(projectPath){try{this.showLoading();let analysisData;if(projectPath.startsWith('http: analysisData=await this.analyzeWebProject(projectPath);}else{analysisData=this.analyzeLocalProject(projectPath);}this.displayResults(analysisData);this.hideLoading();}catch(error){this.hideLoading();alert('å°ˆæ¡ˆåˆ†æå¤±æ•—ï¼Œè«‹æª¢æŸ¥è·¯å¾‘æ˜¯å¦æ­£ç¢º');}}async analyzeUploadedFiles(files){try{this.showLoading();const fileContents=await this.readFiles(files);const analysisData=this.performRealProjectAnalysis(fileContents);this.displayResults(analysisData);this.hideLoading();}catch(error){this.hideLoading();alert('æª”æ¡ˆåˆ†æå¤±æ•—');}}async readFiles(files){const fileContents=[];for(const file of files){const content=await this.readFileContent(file);fileContents.push({name: file.name,size: file.size,content: content,lastModified: file.lastModified});}return fileContents;}readFileContent(file){return new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=(e)=> resolve(e.target.result);reader.onerror=(e)=> reject(e);reader.readAsText(file);});}performRealProjectAnalysis(fileContents){return{projectInfo:{name: 'æ™ºèƒ½å°ˆæ¡ˆåˆ†æ',type: 'å¤šæª”æ¡ˆå°ˆæ¡ˆ',technology: this.detectTechnologies(fileContents),status: 'æ™ºèƒ½åˆ†æå®Œæˆ',lastUpdate: new Date().toLocaleDateString(),fileCount: fileContents.length},projectStructure:{files: fileContents.map(file=>({name: file.name,size: Core.Utils.formatFileSize(file.size),type: this.getFileType(file.name),lines: this.countLines(file.content),lastModified: new Date(file.lastModified).toLocaleDateString()})),directories: []},projectFeatures: this.detectFeatures(fileContents),recommendations: this.generateRecommendations(fileContents),issues: this.detectIssues(fileContents),statistics: this.calculateStatistics(fileContents),codeAnalysis: this.analyzeCodeQuality(fileContents)};}detectTechnologies(fileContents){const technologies=new Set();fileContents.forEach(file=>{const content=file.content.toLowerCase();const ext=this.getFileExtension(file.name);if(ext==='html' && content.includes('react'))technologies.add('React');if(ext==='html' && content.includes('vue'))technologies.add('Vue.js');if(ext==='html' && content.includes('angular'))technologies.add('Angular');if(ext==='js' && content.includes('jquery'))technologies.add('jQuery');if(ext==='css' && content.includes('bootstrap'))technologies.add('Bootstrap');if(ext==='css' && content.includes('tailwind'))technologies.add('Tailwind CSS');});return Array.from(technologies).join(',')|| 'HTML5,CSS3,JavaScript';}detectFeatures(fileContents){const features=new Set();fileContents.forEach(file=>{const content=file.content.toLowerCase();if(content.includes('<form'))features.add('è¡¨å–®è™•ç†');if(content.includes('addeventlistener'))features.add('äº‹ä»¶è™•ç†');if(content.includes('localstorage'))features.add('æœ¬åœ°å„²å­˜');if(content.includes('fetch(')|| content.includes('xmlhttprequest'))features.add('API èª¿ç”¨');if(content.includes('@media')|| content.includes('viewport'))features.add('éŸ¿æ‡‰å¼è¨­è¨ˆ');if(content.includes('animation')|| content.includes('transition'))features.add('å‹•ç•«æ•ˆæœ');});return Array.from(features);}generateRecommendations(fileContents){const recommendations=[];const hasConsoleLog=fileContents.some(file=> file.content.includes('console.log'));if(hasConsoleLog){recommendations.push({title: 'ç§»é™¤ console.log èªå¥',description: 'ç”Ÿç”¢ç’°å¢ƒä¸­æ‡‰ç§»é™¤ console.log èªå¥',priority: 'low',solution: 'åœ¨éƒ¨ç½²å‰ç§»é™¤æ‰€æœ‰ console.log èªå¥'});}const hasDoctype=fileContents.some(file=> file.content.includes('<!DOCTYPE html>'));if(!hasDoctype){recommendations.push({title: 'æ·»åŠ  DOCTYPE è²æ˜',description: 'HTML æ–‡ä»¶ç¼ºå°‘ DOCTYPE è²æ˜',priority: 'high',solution: 'åœ¨ HTML æ–‡ä»¶é–‹é ­æ·»åŠ  <!DOCTYPE html> è²æ˜'});}return recommendations;}detectIssues(fileContents){const issues=[];fileContents.forEach(file=>{const content=file.content;const ext=this.getFileExtension(file.name);if(ext==='html' && !content.includes('<!DOCTYPE html>')){issues.push({type: 'error',title: 'ç¼ºå°‘ DOCTYPE è²æ˜',description: 'HTML æ–‡ä»¶ç¼ºå°‘ DOCTYPE è²æ˜ï¼Œå¯èƒ½å°è‡´æ¨£å¼å•é¡Œ',file: file.name});}if(ext==='html' && !content.includes('name="viewport"')){issues.push({type: 'warning',title: 'ç¼ºå°‘éŸ¿æ‡‰å¼ viewport',description: 'ç¼ºå°‘ viewport meta æ¨™ç±¤ï¼Œå½±éŸ¿è¡Œå‹•è£ç½®é¡¯ç¤º',file: file.name});}});return issues;}calculateStatistics(fileContents){let totalSize=0;let totalLines=0;let totalComments=0;fileContents.forEach(file=>{totalSize +=file.size;totalLines +=this.countLines(file.content);totalComments +=this.countComments(file.content);});return{totalFiles: fileContents.length,totalSize: Core.Utils.formatFileSize(totalSize),totalLines: totalLines,commentLines: totalComments,complexity: totalLines > 1000 ? 'è¤‡é›œ' : totalLines > 500 ? 'ä¸­ç­‰' : 'ç°¡å–®'};}analyzeCodeQuality(fileContents){let totalScore=0;let fileCount=0;fileContents.forEach(file=>{const ext=this.getFileExtension(file.name);let score=100;if(ext==='html'){if(!file.content.includes('<!DOCTYPE html>'))score -=20;if(!file.content.includes('name="viewport"'))score -=10;}if(ext==='js'){if(file.content.includes('var '))score -=5;if(file.content.includes('=='))score -=5;}totalScore +=score;fileCount++;});const averageScore=fileCount > 0 ? Math.round(totalScore / fileCount): 0;return{overall:{score: averageScore,grade: this.getGrade(averageScore)},html:{score: 85,issues: []},css:{score: 80,issues: []},js:{score: 75,issues: []}};}getGrade(score){if(score >=90)return 'A';if(score >=80)return 'B';if(score >=70)return 'C';if(score >=60)return 'D';return 'F';}getFileType(filename){const ext=this.getFileExtension(filename);const typeMap={'html': 'HTML æª”æ¡ˆ','htm': 'HTML æª”æ¡ˆ','css': 'CSS æ¨£å¼è¡¨','js': 'JavaScript æª”æ¡ˆ','json': 'JSON æª”æ¡ˆ','md': 'Markdown æª”æ¡ˆ','txt': 'æ–‡å­—æª”æ¡ˆ','xml': 'XML æª”æ¡ˆ','php': 'PHP æª”æ¡ˆ','py': 'Python æª”æ¡ˆ','java': 'Java æª”æ¡ˆ','cpp': 'C++ æª”æ¡ˆ','c': 'C æª”æ¡ˆ','h': 'C æ¨™é ­æª”æ¡ˆ','hpp': 'C++ æ¨™é ­æª”æ¡ˆ','cs': 'C# æª”æ¡ˆ','rb': 'Ruby æª”æ¡ˆ','go': 'Go æª”æ¡ˆ','rs': 'Rust æª”æ¡ˆ','ts': 'TypeScript æª”æ¡ˆ','jsx': 'JSX æª”æ¡ˆ','tsx': 'TSX æª”æ¡ˆ','vue': 'Vue æª”æ¡ˆ','svelte': 'Svelte æª”æ¡ˆ'};return typeMap[ext] || 'æœªçŸ¥æª”æ¡ˆ';}getFileExtension(filename){return filename.split('.').pop().toLowerCase();}countLines(content){return content.split('\n').length;}countComments(content){const lines=content.split('\n');return lines.filter(line=> line.trim().startsWith(' line.trim().startsWith('/*')|| line.trim().startsWith('*')|| line.trim().startsWith('<!--')).length;}displayResults(data){const analysisResults=document.getElementById('analysisResults');const analysisContent=document.getElementById('analysisContent');if(!analysisResults || !analysisContent)return;this.analysisData=data;const html=this.generateResultsHTML(data);analysisContent.innerHTML=html;analysisResults.style.display='block';Core.Utils.smoothScrollTo(analysisResults);}generateResultsHTML(data){return ` <div class="project-section project-info"> <h5>ğŸ“Š å°ˆæ¡ˆè³‡è¨Š</h5> <div class="info-grid"> <div class="info-item"> <span class="info-label">å°ˆæ¡ˆåç¨±ï¼š</span> <span class="info-value">${data.projectInfo.name}</span> </div> <div class="info-item"> <span class="info-label">å°ˆæ¡ˆé¡å‹ï¼š</span> <span class="info-value">${data.projectInfo.type}</span> </div> <div class="info-item"> <span class="info-label">ä¸»è¦æŠ€è¡“ï¼š</span> <span class="info-value">${data.projectInfo.technology}</span> </div> <div class="info-item"> <span class="info-label">åˆ†æç‹€æ…‹ï¼š</span> <span class="info-value">${data.projectInfo.status}</span> </div> </div> </div> <div class="project-section project-structure"> <h5>ğŸ“ å°ˆæ¡ˆçµæ§‹</h5> <div class="file-list"> ${data.projectStructure.files.map(file=> ` <div class="file-item"> <i class="fas fa-file-code"></i> <div class="file-info"> <span class="file-name">${file.name}</span> <span class="file-details">${file.type}â€¢ ${file.size}â€¢ ${file.lines}è¡Œ</span> </div> </div> `).join('')}</div> </div> <div class="project-section project-features"> <h5>âœ¨ å°ˆæ¡ˆåŠŸèƒ½</h5> <div class="features-list"> ${data.projectFeatures.map(feature=> ` <span class="feature-tag">${feature}</span> `).join('')}</div> </div> <div class="project-section project-recommendations"> <h5>ğŸ’¡ å„ªåŒ–å»ºè­°</h5> ${data.recommendations.map(rec=> ` <div class="recommendation-item"> <h6>${rec.title}</h6> <p>${rec.description}</p> ${rec.solution ? `<div class="solution">${rec.solution}</div>` : ''}</div> `).join('')}</div> <div class="project-section project-issues"> <h5>âš ï¸ ç™¼ç¾å•é¡Œ</h5> ${data.issues.map(issue=> ` <div class="issue-item ${issue.type}"> <h6>${issue.title}</h6> <p>${issue.description}</p> ${issue.file ? `<small>æª”æ¡ˆ: ${issue.file}</small>` : ''}</div> `).join('')}</div> <div class="project-section project-statistics"> <h5>ğŸ“ˆ çµ±è¨ˆè³‡æ–™</h5> <div class="stats-grid"> <div class="stat-item"> <span class="stat-label">ç¸½æª”æ¡ˆæ•¸</span> <span class="stat-value">${data.statistics.totalFiles}</span> </div> <div class="stat-item"> <span class="stat-label">ç¸½å¤§å°</span> <span class="stat-value">${data.statistics.totalSize}</span> </div> <div class="stat-item"> <span class="stat-label">ç¸½è¡Œæ•¸</span> <span class="stat-value">${data.statistics.totalLines}</span> </div> <div class="stat-item"> <span class="stat-label">è¨»è§£è¡Œæ•¸</span> <span class="stat-value">${data.statistics.commentLines}</span> </div> </div> </div> `;}showLoading(){const analyzeBtn=document.getElementById('analyzeProject');if(analyzeBtn){analyzeBtn.innerHTML='<i class="fas fa-spinner fa-spin"></i> åˆ†æä¸­...';analyzeBtn.disabled=true;}}hideLoading(){const analyzeBtn=document.getElementById('analyzeProject');if(analyzeBtn){analyzeBtn.innerHTML='<i class="fas fa-analytics"></i> åˆ†æå°ˆæ¡ˆçµæ§‹';analyzeBtn.disabled=false;}}}const projectAnalyzer=new ProjectAnalyzer();window.ProjectAnalyzer=ProjectAnalyzer;window.projectAnalyzer=projectAnalyzer;